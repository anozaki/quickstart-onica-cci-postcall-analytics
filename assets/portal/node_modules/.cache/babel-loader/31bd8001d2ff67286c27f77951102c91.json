{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sshvans/Documents/work/quickstart/quickstart-onica-cci-postcall-analytics/assets/portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sshvans/Documents/work/quickstart/quickstart-onica-cci-postcall-analytics/assets/portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/sshvans/Documents/work/quickstart/quickstart-onica-cci-postcall-analytics/assets/portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/sshvans/Documents/work/quickstart/quickstart-onica-cci-postcall-analytics/assets/portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/sshvans/Documents/work/quickstart/quickstart-onica-cci-postcall-analytics/assets/portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/sshvans/Documents/work/quickstart/quickstart-onica-cci-postcall-analytics/assets/portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{connect}from'react-redux';import{AppBar,Toolbar,IconButton,Grid,Typography,withStyles,createMuiTheme}from\"@material-ui/core\";import{Auth}from'aws-amplify';import{ExitToApp}from'@material-ui/icons';import{AuthAction}from\"../store/actions/auth.actions\";import AuthRoles from\"../auth/AuthRoles\";import{MuiThemeProvider}from\"@material-ui/core\";import themeColors from\"../theme/colors\";import CloudUploadIcon from'@material-ui/icons/CloudUpload';import{ApiService}from\"../service/api.service\";import*as AWSGlobal from'aws-sdk/global';import AWS from'aws-sdk';var apiService=new ApiService();var region=process.env.REACT_APP_COGNITO_DOMAIN.split('.')[2];var styles=function styles(theme){return{root:{flexGrow:1},logo:{margin:\"5px 10px 0 0\",height:43},grow:{flexGrow:1},userInfo:{marginRight:10},role:{fontSize:12,textAlign:\"right\",fontWeight:\"bold\",margin:\"4px 0 -2px 0\",paddingTop:3},email:{fontSize:12,fontWeight:\"light\",textAlign:\"right\",margin:\"-2px 0 0 0\",padding:0},clickable:{cursor:\"pointer\"}};};var theme=new createMuiTheme({palette:{primary:{main:themeColors.navBar}}});var NavigationBar=/*#__PURE__*/function(_Component){_inherits(NavigationBar,_Component);var _super=_createSuper(NavigationBar);function NavigationBar(){var _this;_classCallCheck(this,NavigationBar);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.handleOnLogout=function(){_this.props.logout();};_this.goToUpload=function(){return _this.props.history.push(\"/upload\");};_this.goToQuickSight=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var thisUrlEncoded,quicksightUrlEncoded,auth,id_token,cognitoParams;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:thisUrlEncoded=encodeURIComponent(\"https://\"+window.location.hostname);quicksightUrlEncoded=encodeURIComponent(\"https://\".concat(region,\".quicksight.aws.amazon.com/\"));AWS.config.region=region;_context.next=5;return apiService.getAuth();case 5:auth=_context.sent;id_token=auth.idToken;cognitoParams={IdentityPoolId:process.env.REACT_APP_COGNITO_IDENTITY_POOL_ID,Logins:{}};cognitoParams.Logins[\"cognito-idp.\".concat(region,\".amazonaws.com/\").concat(process.env.REACT_APP_COGNITO_USER_POOL_ID)]=id_token;AWS.config.credentials=new AWS.CognitoIdentityCredentials(cognitoParams);AWS.config.credentials.refresh(function(error){if(error){console.error(error);}else{console.log(\"successful\");}});AWS.config.getCredentials(function(){var creds={\"sessionId\":AWS.config.credentials.accessKeyId,\"sessionKey\":AWS.config.credentials.secretAccessKey,\"sessionToken\":AWS.config.credentials.sessionToken};var credsEncoded=encodeURIComponent(JSON.stringify(creds));var uri=\"https://signin.aws.amazon.com/federation?Action=getSigninToken&SessionDuration=43200&Session=\"+credsEncoded;var options={method:'POST',headers:{Authorization:auth.accessToken},redirect:'follow',referrerPolicy:'no-referrer',body:uri};fetch(\"\".concat(process.env.REACT_APP_BASE_API,\"/auth\"),options).then(function(response){return response.json();}).then(function(data){var quickSightSSO=\"https://signin.aws.amazon.com/federation?Action=login&Issuer=\"+thisUrlEncoded+\"&Destination=\"+quicksightUrlEncoded+\"&SigninToken=\"+data.SigninToken;console.log(\"AWS Console Sign In URL: \"+quickSightSSO);window.location=quickSightSSO;});});case 12:case\"end\":return _context.stop();}}},_callee);}));_this.goHome=function(){return _this.props.history.push(\"/calls\");};return _this;}_createClass(NavigationBar,[{key:\"render\",value:function render(){var classes=this.props.classes;return/*#__PURE__*/React.createElement(MuiThemeProvider,{theme:theme},/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(AppBar,{position:\"static\"},/*#__PURE__*/React.createElement(Toolbar,null,/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"row\",justify:\"space-between\",alignContent:\"center\",alignItems:\"center\"},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"row\",alignItems:\"center\",alignContent:\"center\"},/*#__PURE__*/React.createElement(Grid,{item:true,onClick:this.goHome,className:classes.clickable},/*#__PURE__*/React.createElement(Typography,{variant:\"h5\"},\"Call Analytics\")))),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"row\",alignItems:\"center\",alignContent:\"center\"},/*#__PURE__*/React.createElement(Grid,{item:true,onClick:this.goToQuickSight,className:classes.clickable},/*#__PURE__*/React.createElement(\"img\",{alt:\"Amazon QuickSight Logo\",className:classes.logo,src:process.env.PUBLIC_URL+'/images/quicksight.png'})),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Typography,{variant:\"h5\"},\"QuickSight\")))),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"row\"},/*#__PURE__*/React.createElement(Grid,{item:true,className:classes.userInfo},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"column\",alignContent:\"center\",alignItems:\"flex-end\"},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(\"p\",{className:classes.role},this.props.userRole)),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(\"p\",{className:classes.email},this.props.userEmail)))),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"column\",alignItems:\"center\",onClick:this.goToUpload,className:classes.clickable},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(IconButton,{style:{padding:0,paddingLeft:12,paddingRight:12},color:\"inherit\"},/*#__PURE__*/React.createElement(CloudUploadIcon,null))),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(\"p\",{className:classes.email},\"Upload\")))),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Grid,{container:true,direction:\"row\",alignItems:\"center\"},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(IconButton,{color:\"inherit\",onClick:this.handleOnLogout},/*#__PURE__*/React.createElement(ExitToApp,null))))))))))));}}]);return NavigationBar;}(Component);var mapStateToProps=function mapStateToProps(state){var role=\"\";if(!state.auth.user){return{userEmail:null,userRole:null};}var roles=state.auth.user[\"roles\"]||[];if(roles.includes(AuthRoles.MANAGER)){role=\"Manager\";}if(roles.includes(AuthRoles.ADMIN)){role=\"Administrator\";}if(!role){role=\"Agent\";}return{userEmail:state.auth.user[\"email\"],userRole:role};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{logout:function logout(){return dispatch(AuthAction.logout());}};};export default connect(mapStateToProps,mapDispatchToProps)(withStyles(styles)(NavigationBar));","map":{"version":3,"sources":["/Users/sshvans/Documents/work/quickstart/quickstart-onica-cci-postcall-analytics/assets/portal/src/navigation/NavigationBar.js"],"names":["React","Component","connect","AppBar","Toolbar","IconButton","Grid","Typography","withStyles","createMuiTheme","Auth","ExitToApp","AuthAction","AuthRoles","MuiThemeProvider","themeColors","CloudUploadIcon","ApiService","AWSGlobal","AWS","apiService","region","process","env","REACT_APP_COGNITO_DOMAIN","split","styles","theme","root","flexGrow","logo","margin","height","grow","userInfo","marginRight","role","fontSize","textAlign","fontWeight","paddingTop","email","padding","clickable","cursor","palette","primary","main","navBar","NavigationBar","handleOnLogout","props","logout","goToUpload","history","push","goToQuickSight","thisUrlEncoded","encodeURIComponent","window","location","hostname","quicksightUrlEncoded","config","getAuth","auth","id_token","idToken","cognitoParams","IdentityPoolId","REACT_APP_COGNITO_IDENTITY_POOL_ID","Logins","REACT_APP_COGNITO_USER_POOL_ID","credentials","CognitoIdentityCredentials","refresh","error","console","log","getCredentials","creds","accessKeyId","secretAccessKey","sessionToken","credsEncoded","JSON","stringify","uri","options","method","headers","Authorization","accessToken","redirect","referrerPolicy","body","fetch","REACT_APP_BASE_API","then","response","json","data","quickSightSSO","SigninToken","goHome","classes","PUBLIC_URL","userRole","userEmail","paddingLeft","paddingRight","mapStateToProps","state","user","roles","includes","MANAGER","ADMIN","mapDispatchToProps","dispatch"],"mappings":"2uCAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,KAA+B,OAA/B,CACA,OAAQC,OAAR,KAAsB,aAAtB,CACA,OACIC,MADJ,CAEIC,OAFJ,CAGIC,UAHJ,CAGgBC,IAHhB,CAIIC,UAJJ,CAIgBC,UAJhB,CAI4BC,cAJ5B,KAKO,mBALP,CAMA,OAAQC,IAAR,KAAmB,aAAnB,CAEA,OAAQC,SAAR,KAAwB,oBAAxB,CAEA,OAAQC,UAAR,KAAyB,+BAAzB,CACA,MAAOC,CAAAA,SAAP,KAAsB,mBAAtB,CACA,OAAQC,gBAAR,KAA+B,mBAA/B,CACA,MAAOC,CAAAA,WAAP,KAAwB,iBAAxB,CACA,MAAOC,CAAAA,eAAP,KAA4B,gCAA5B,CACA,OAAQC,UAAR,KAAyB,wBAAzB,CACA,MAAO,GAAKC,CAAAA,SAAZ,KAA2B,gBAA3B,CACA,MAAOC,CAAAA,GAAP,KAAgB,SAAhB,CAIA,GAAMC,CAAAA,UAAU,CAAG,GAAIH,CAAAA,UAAJ,EAAnB,CACA,GAAII,CAAAA,MAAM,CAAGC,OAAO,CAACC,GAAR,CAAYC,wBAAZ,CAAqCC,KAArC,CAA2C,GAA3C,EAAgD,CAAhD,CAAb,CAEA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAACC,KAAD,QAAY,CACvBC,IAAI,CAAE,CACFC,QAAQ,CAAE,CADR,CADiB,CAIvBC,IAAI,CAAE,CACFC,MAAM,CAAE,cADN,CAEFC,MAAM,CAAE,EAFN,CAJiB,CAQvBC,IAAI,CAAE,CACFJ,QAAQ,CAAE,CADR,CARiB,CAWvBK,QAAQ,CAAE,CACNC,WAAW,CAAE,EADP,CAXa,CAcvBC,IAAI,CAAE,CACFC,QAAQ,CAAE,EADR,CAEFC,SAAS,CAAE,OAFT,CAGFC,UAAU,CAAE,MAHV,CAIFR,MAAM,CAAE,cAJN,CAKFS,UAAU,CAAE,CALV,CAdiB,CAqBvBC,KAAK,CAAE,CACHJ,QAAQ,CAAE,EADP,CAEHE,UAAU,CAAE,OAFT,CAGHD,SAAS,CAAE,OAHR,CAIHP,MAAM,CAAE,YAJL,CAKHW,OAAO,CAAE,CALN,CArBgB,CA4BvBC,SAAS,CAAE,CACPC,MAAM,CAAE,SADD,CA5BY,CAAZ,EAAf,CAiCA,GAAMjB,CAAAA,KAAK,CAAG,GAAIlB,CAAAA,cAAJ,CAAmB,CAC7BoC,OAAO,CAAE,CACLC,OAAO,CAAE,CACLC,IAAI,CAAEhC,WAAW,CAACiC,MADb,CADJ,CADoB,CAAnB,CAAd,C,GASMC,CAAAA,a,uVAEFC,c,CAAiB,UAAM,CACnB,MAAKC,KAAL,CAAWC,MAAX,GACH,C,OAEDC,U,CAAa,iBAAM,OAAKF,KAAL,CAAWG,OAAX,CAAmBC,IAAnB,CAAwB,SAAxB,CAAN,E,OAEbC,c,sEAAiB,uMACTC,cADS,CACQC,kBAAkB,CAAC,WAAWC,MAAM,CAACC,QAAP,CAAgBC,QAA5B,CAD1B,CAETC,oBAFS,CAEcJ,kBAAkB,mBAAYrC,MAAZ,gCAFhC,CAGbF,GAAG,CAAC4C,MAAJ,CAAW1C,MAAX,CAAoBA,MAApB,CAHa,sBAKMD,CAAAA,UAAU,CAAC4C,OAAX,EALN,QAKPC,IALO,eAOTC,QAPS,CAOED,IAAI,CAACE,OAPP,CAQTC,aARS,CAQO,CAChBC,cAAc,CAAE/C,OAAO,CAACC,GAAR,CAAY+C,kCADZ,CAEhBC,MAAM,CAAE,EAFQ,CARP,CAabH,aAAa,CAACG,MAAd,uBAAoClD,MAApC,2BAA4DC,OAAO,CAACC,GAAR,CAAYiD,8BAAxE,GAA4GN,QAA5G,CAEA/C,GAAG,CAAC4C,MAAJ,CAAWU,WAAX,CAAyB,GAAItD,CAAAA,GAAG,CAACuD,0BAAR,CAAmCN,aAAnC,CAAzB,CAEAjD,GAAG,CAAC4C,MAAJ,CAAWU,WAAX,CAAuBE,OAAvB,CAA+B,SAAAC,KAAK,CAAI,CACpC,GAAIA,KAAJ,CAAW,CACPC,OAAO,CAACD,KAAR,CAAcA,KAAd,EACH,CAFD,IAEO,CAACC,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA2B,CACtC,CAJD,EAMA3D,GAAG,CAAC4C,MAAJ,CAAWgB,cAAX,CAA0B,UAAY,CAClC,GAAIC,CAAAA,KAAK,CAAG,CACR,YAAY7D,GAAG,CAAC4C,MAAJ,CAAWU,WAAX,CAAuBQ,WAD3B,CAER,aAAa9D,GAAG,CAAC4C,MAAJ,CAAWU,WAAX,CAAuBS,eAF5B,CAGR,eAAe/D,GAAG,CAAC4C,MAAJ,CAAWU,WAAX,CAAuBU,YAH9B,CAAZ,CAMA,GAAIC,CAAAA,YAAY,CAAG1B,kBAAkB,CAAC2B,IAAI,CAACC,SAAL,CAAeN,KAAf,CAAD,CAArC,CAEA,GAAIO,CAAAA,GAAG,CAAG,gGAAgGH,YAA1G,CAEA,GAAMI,CAAAA,OAAO,CAAG,CACZC,MAAM,CAAE,MADI,CAEZC,OAAO,CAAE,CACLC,aAAa,CAAG1B,IAAI,CAAC2B,WADhB,CAFG,CAKZC,QAAQ,CAAE,QALE,CAMZC,cAAc,CAAE,aANJ,CAOZC,IAAI,CAAER,GAPM,CAAhB,CAUAS,KAAK,WAAI1E,OAAO,CAACC,GAAR,CAAY0E,kBAAhB,UAA2CT,OAA3C,CAAL,CACCU,IADD,CACM,SAAAC,QAAQ,CAAI,CACd,MAAOA,CAAAA,QAAQ,CAACC,IAAT,EAAP,CACH,CAHD,EAICF,IAJD,CAIM,SAAAG,IAAI,CAAI,CACV,GAAIC,CAAAA,aAAa,CAAG,gEAAgE7C,cAAhE,CAA+E,eAA/E,CAA+FK,oBAA/F,CAAoH,eAApH,CAAoIuC,IAAI,CAACE,WAA7J,CAEA1B,OAAO,CAACC,GAAR,CAAY,4BAA4BwB,aAAxC,EACA3C,MAAM,CAACC,QAAP,CAAkB0C,aAAlB,CACH,CATD,EAUH,CA/BD,EAvBa,uD,SAyDjBE,M,CAAS,iBAAM,OAAKrD,KAAL,CAAWG,OAAX,CAAmBC,IAAnB,CAAwB,QAAxB,CAAN,E,gFAEA,IACAkD,CAAAA,OADA,CACW,KAAKtD,KADhB,CACAsD,OADA,CAEL,mBACI,oBAAC,gBAAD,EAAkB,KAAK,CAAE9E,KAAzB,eACI,2BAAK,SAAS,CAAE8E,OAAO,CAAC7E,IAAxB,eACI,oBAAC,MAAD,EAAQ,QAAQ,CAAC,QAAjB,eACI,oBAAC,OAAD,mBACI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAC,KAA1B,CAAgC,OAAO,CAAC,eAAxC,CAAwD,YAAY,CAAC,QAArE,CACM,UAAU,CAAC,QADjB,eAEI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAC,KAA1B,CAAgC,UAAU,CAAC,QAA3C,CAAoD,YAAY,CAAC,QAAjE,eAEI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,OAAO,CAAE,KAAK4E,MAAzB,CAAiC,SAAS,CAAEC,OAAO,CAAC9D,SAApD,eACI,oBAAC,UAAD,EAAY,OAAO,CAAC,IAApB,mBADJ,CAFJ,CADJ,CAFJ,cAYI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAC,KAA1B,CAAgC,UAAU,CAAC,QAA3C,CAAoD,YAAY,CAAC,QAAjE,eACI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,OAAO,CAAE,KAAKa,cAAzB,CAAyC,SAAS,CAAEiD,OAAO,CAAC9D,SAA5D,eACI,2BAAK,GAAG,CAAC,wBAAT,CAAkC,SAAS,CAAE8D,OAAO,CAAC3E,IAArD,CACK,GAAG,CAAER,OAAO,CAACC,GAAR,CAAYmF,UAAZ,CAAyB,wBADnC,EADJ,CADJ,cAKI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,UAAD,EAAY,OAAO,CAAC,IAApB,eADJ,CALJ,CADJ,CAZJ,cAyBI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAC,KAA1B,eACI,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,SAAS,CAAED,OAAO,CAACvE,QAA9B,eACI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAC,QAA1B,CAAmC,YAAY,CAAC,QAAhD,CACM,UAAU,CAAC,UADjB,eAEI,oBAAC,IAAD,EAAM,IAAI,KAAV,eAAW,yBAAG,SAAS,CAAEuE,OAAO,CAACrE,IAAtB,EAA6B,KAAKe,KAAL,CAAWwD,QAAxC,CAAX,CAFJ,cAGI,oBAAC,IAAD,EAAM,IAAI,KAAV,eAAW,yBAAG,SAAS,CAAEF,OAAO,CAAChE,KAAtB,EAA8B,KAAKU,KAAL,CAAWyD,SAAzC,CAAX,CAHJ,CADJ,CADJ,cASI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAC,QAA1B,CAAmC,UAAU,CAAE,QAA/C,CAAyD,OAAO,CAAE,KAAKvD,UAAvE,CAAmF,SAAS,CAAEoD,OAAO,CAAC9D,SAAtG,eACI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,UAAD,EAAY,KAAK,CAAE,CAAED,OAAO,CAAE,CAAX,CAAcmE,WAAW,CAAE,EAA3B,CAA+BC,YAAY,CAAE,EAA7C,CAAnB,CAAsE,KAAK,CAAC,SAA5E,eACI,oBAAC,eAAD,MADJ,CADJ,CADJ,cAMI,oBAAC,IAAD,EAAM,IAAI,KAAV,eAAW,yBAAG,SAAS,CAAEL,OAAO,CAAChE,KAAtB,WAAX,CANJ,CADJ,CATJ,cAmBI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,SAAS,CAAC,KAA1B,CAAgC,UAAU,CAAE,QAA5C,eACI,oBAAC,IAAD,EAAM,IAAI,KAAV,eACI,oBAAC,UAAD,EAAY,KAAK,CAAC,SAAlB,CAA4B,OAAO,CAAE,KAAKS,cAA1C,eACI,oBAAC,SAAD,MADJ,CADJ,CADJ,CADJ,CAnBJ,CADJ,CAzBJ,CADJ,CADJ,CADJ,CADJ,CADJ,CAmEH,C,2BAxIuBjD,S,EAmJ5B,GAAM8G,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,KAAD,CAAW,CAC/B,GAAI5E,CAAAA,IAAI,CAAG,EAAX,CACA,GAAI,CAAC4E,KAAK,CAAC/C,IAAN,CAAWgD,IAAhB,CAAsB,CAClB,MAAO,CACHL,SAAS,CAAE,IADR,CAEHD,QAAQ,CAAE,IAFP,CAAP,CAIH,CAED,GAAIO,CAAAA,KAAK,CAAGF,KAAK,CAAC/C,IAAN,CAAWgD,IAAX,CAAgB,OAAhB,GAA4B,EAAxC,CACA,GAAIC,KAAK,CAACC,QAAN,CAAetG,SAAS,CAACuG,OAAzB,CAAJ,CAAuC,CACnChF,IAAI,CAAG,SAAP,CACH,CAED,GAAI8E,KAAK,CAACC,QAAN,CAAetG,SAAS,CAACwG,KAAzB,CAAJ,CAAqC,CACjCjF,IAAI,CAAG,eAAP,CACH,CAED,GAAI,CAACA,IAAL,CAAW,CACPA,IAAI,CAAG,OAAP,CACH,CAED,MAAO,CACHwE,SAAS,CAAEI,KAAK,CAAC/C,IAAN,CAAWgD,IAAX,CAAgB,OAAhB,CADR,CAEHN,QAAQ,CAAEvE,IAFP,CAAP,CAIH,CA1BD,CA4BA,GAAMkF,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACC,QAAD,CAAc,CACrC,MAAO,CACHnE,MAAM,CAAE,wBAAMmE,CAAAA,QAAQ,CAAC3G,UAAU,CAACwC,MAAX,EAAD,CAAd,EADL,CAAP,CAGH,CAJD,CAOA,cAAelD,CAAAA,OAAO,CAAC6G,eAAD,CAAkBO,kBAAlB,CAAP,CAA6C9G,UAAU,CAACkB,MAAD,CAAV,CAAmBuB,aAAnB,CAA7C,CAAf","sourcesContent":["import React, {Component} from 'react';\nimport {connect} from 'react-redux';\nimport {\n    AppBar,\n    Toolbar,\n    IconButton, Grid,\n    Typography, withStyles, createMuiTheme\n} from \"@material-ui/core\";\nimport {Auth} from 'aws-amplify';\n\nimport {ExitToApp} from '@material-ui/icons';\nimport PropTypes from \"prop-types\";\nimport {AuthAction} from \"../store/actions/auth.actions\";\nimport AuthRoles from \"../auth/AuthRoles\";\nimport {MuiThemeProvider} from \"@material-ui/core\";\nimport themeColors from \"../theme/colors\";\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport {ApiService} from \"../service/api.service\"\nimport * as AWSGlobal from 'aws-sdk/global';\nimport AWS from 'aws-sdk';\n\n\n\nconst apiService = new ApiService()\nlet region = process.env.REACT_APP_COGNITO_DOMAIN.split('.')[2]\n\nconst styles = (theme) => ({\n    root: {\n        flexGrow: 1\n    },\n    logo: {\n        margin: \"5px 10px 0 0\",\n        height: 43\n    },\n    grow: {\n        flexGrow: 1\n    },\n    userInfo: {\n        marginRight: 10\n    },\n    role: {\n        fontSize: 12,\n        textAlign: \"right\",\n        fontWeight: \"bold\",\n        margin: \"4px 0 -2px 0\",\n        paddingTop: 3\n    },\n    email: {\n        fontSize: 12,\n        fontWeight: \"light\",\n        textAlign: \"right\",\n        margin: \"-2px 0 0 0\",\n        padding: 0\n    },\n    clickable: {\n        cursor: \"pointer\"\n    }\n});\n\nconst theme = new createMuiTheme({\n    palette: {\n        primary: {\n            main: themeColors.navBar\n        }\n    }\n});\n\n\nclass NavigationBar extends Component {\n\n    handleOnLogout = () => {\n        this.props.logout();\n    };\n\n    goToUpload = () => this.props.history.push(\"/upload\");\n\n    goToQuickSight = async () => {\n        let thisUrlEncoded = encodeURIComponent(\"https://\"+window.location.hostname);\n        let quicksightUrlEncoded = encodeURIComponent(`https://${region}.quicksight.aws.amazon.com/`);\n        AWS.config.region = region;\n\n        const auth = await apiService.getAuth()\n\n        let id_token = auth.idToken;\n        let cognitoParams = {\n            IdentityPoolId: process.env.REACT_APP_COGNITO_IDENTITY_POOL_ID,\n            Logins: {}\n        };\n\n        cognitoParams.Logins[`cognito-idp.${region}.amazonaws.com/${process.env.REACT_APP_COGNITO_USER_POOL_ID}`] = id_token;\n\n        AWS.config.credentials = new AWS.CognitoIdentityCredentials(cognitoParams);\n            \n        AWS.config.credentials.refresh(error => {\n            if (error) {\n                console.error(error);\n            } else {console.log(\"successful\") }\n        });\n\n        AWS.config.getCredentials(function () {\n            let creds = {\n                \"sessionId\":AWS.config.credentials.accessKeyId,\n                \"sessionKey\":AWS.config.credentials.secretAccessKey,\n                \"sessionToken\":AWS.config.credentials.sessionToken\n            }\n\n            let credsEncoded = encodeURIComponent(JSON.stringify(creds));\n\n            let uri = \"https://signin.aws.amazon.com/federation?Action=getSigninToken&SessionDuration=43200&Session=\"+credsEncoded;\n    \n            const options = {\n                method: 'POST',\n                headers: {\n                    Authorization : auth.accessToken,\n                },\n                redirect: 'follow', \n                referrerPolicy: 'no-referrer',\n                body: uri\n            }\n    \n            fetch(`${process.env.REACT_APP_BASE_API}/auth`, options)\n            .then(response => {\n                return response.json();\n            })\n            .then(data => {\n                let quickSightSSO = \"https://signin.aws.amazon.com/federation?Action=login&Issuer=\"+thisUrlEncoded+\"&Destination=\"+quicksightUrlEncoded+\"&SigninToken=\"+data.SigninToken\n            \n                console.log(\"AWS Console Sign In URL: \"+quickSightSSO);\n                window.location = quickSightSSO;\n            });\n        })    \n    }\n\n    goHome = () => this.props.history.push(\"/calls\")\n\n    render() {\n        let {classes} = this.props;\n        return (\n            <MuiThemeProvider theme={theme}>\n                <div className={classes.root}>\n                    <AppBar position=\"static\">\n                        <Toolbar>\n                            <Grid container direction=\"row\" justify=\"space-between\" alignContent=\"center\"\n                                  alignItems=\"center\">\n                                <Grid item>\n                                    <Grid container direction=\"row\" alignItems=\"center\" alignContent=\"center\">\n\n                                        <Grid item onClick={this.goHome} className={classes.clickable}>\n                                            <Typography variant=\"h5\">\n                                                Call Analytics\n                                            </Typography>\n                                        </Grid>\n                                    </Grid>\n                                </Grid>\n                                <Grid item>\n                                    <Grid container direction=\"row\" alignItems=\"center\" alignContent=\"center\">\n                                        <Grid item onClick={this.goToQuickSight} className={classes.clickable}>\n                                            <img alt=\"Amazon QuickSight Logo\" className={classes.logo}\n                                                 src={process.env.PUBLIC_URL + '/images/quicksight.png'}/>\n                                        </Grid>\n                                        <Grid item>\n                                            <Typography variant=\"h5\">\n                                                QuickSight\n                                            </Typography>\n                                        </Grid>\n                                    </Grid>\n                                </Grid>\n                                <Grid item>\n                                    <Grid container direction=\"row\">\n                                        <Grid item className={classes.userInfo}>\n                                            <Grid container direction=\"column\" alignContent=\"center\"\n                                                  alignItems=\"flex-end\">\n                                                <Grid item><p className={classes.role}>{this.props.userRole}</p></Grid>\n                                                <Grid item><p className={classes.email}>{this.props.userEmail}</p>\n                                                </Grid>\n                                            </Grid>\n                                        </Grid>\n                                        <Grid item>\n                                            <Grid container direction=\"column\" alignItems={\"center\"} onClick={this.goToUpload} className={classes.clickable}>\n                                                <Grid item >\n                                                    <IconButton style={{ padding: 0, paddingLeft: 12, paddingRight: 12 }} color=\"inherit\">\n                                                        <CloudUploadIcon />\n                                                    </IconButton>\n                                                </Grid>\n                                                <Grid item><p className={classes.email}>Upload</p></Grid>\n                                            </Grid>\n                                        </Grid>\n                                        <Grid item>\n                                            <Grid container direction=\"row\" alignItems={\"center\"}>\n                                                <Grid item>\n                                                    <IconButton color=\"inherit\" onClick={this.handleOnLogout}>\n                                                        <ExitToApp/>\n                                                    </IconButton>\n                                                </Grid>\n                                            </Grid>\n                                        </Grid>\n                                    </Grid>\n                                </Grid>\n                            </Grid>\n                        </Toolbar>\n                    </AppBar>\n                </div>\n            </MuiThemeProvider>\n        );\n    }\n}\n\nNavigationBar.propTypes = {\n    logout: PropTypes.func,\n    history: PropTypes.object,\n    token: PropTypes.string,\n    refreshToken: PropTypes.func,\n    updateToken: PropTypes.func\n};\n\nconst mapStateToProps = (state) => {\n    let role = \"\";\n    if (!state.auth.user) {\n        return {\n            userEmail: null,\n            userRole: null\n        }\n    }\n\n    let roles = state.auth.user[\"roles\"] || [];\n    if (roles.includes(AuthRoles.MANAGER)) {\n        role = \"Manager\";\n    }\n\n    if (roles.includes(AuthRoles.ADMIN)) {\n        role = \"Administrator\"\n    }\n\n    if (!role) {\n        role = \"Agent\"\n    }\n\n    return {\n        userEmail: state.auth.user[\"email\"],\n        userRole: role\n    }\n};\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        logout: () => dispatch(AuthAction.logout()),\n    }\n};\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withStyles(styles)(NavigationBar))"]},"metadata":{},"sourceType":"module"}